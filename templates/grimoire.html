{% import 'macros.html' as macros %}
{% extends "layout.html" %}
{% block body %}
<h2>{{ data.properties.identifier }} (Grimoire)</h2>

{{ macros.description(data.properties) }}

{% if data.editions %}
<div class="card">
    <h3>Editions</h3>
    {% for edition in data.editions %}
    <ul>
        <li>
            <a href="/{{ edition.end.labels[0] }}/{{ edition.end.properties.uid }}">{{ edition.end.properties.identifier }}</a>
            {% if edition.end.properties.editor %}({{ edition.end.properties.editor }}){% endif %}
        </li>
    </ul>
    {% endfor %}
</div>
{% endif %}

{% if data.relationships %}
<div class="card">
    <h3>Connections</h3>
    <ul>
    {% for rel in data.relationships %}
        <li>
            <a href="/{{ rel.start.labels[0] }}/{{ rel.start.properties.uid }}">{{ rel.start.properties.identifier }}</a>
            {{ rel.type | format_rel }}
            <a href="/{{ rel.end.labels[0] }}/{{ rel.end.properties.uid }}">{{ rel.end.properties.identifier }}</a>
        </li>
    {% endfor %}
    </ul>
</div>
{% endif %}

{% for type, items in data.entities.items() %}
{% if items %}
<div class="card">
    <h3>{{ type | format_rel | capitalize | pluralize }} ({{ items | length }})</h3>
    <ul class="many">
        {% for item in items | sort(attribute="end.properties.identifier") %}
        <li>
            <a href="/{{ item.end.labels[0] }}/{{ item.end.properties.uid }}">{{ item.end.properties.identifier }}</a>
        </li>
        {% endfor %}
    </ul>
</div>
{% endif %}
{% endfor %}

{% endblock %}

